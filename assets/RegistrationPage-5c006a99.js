import{J as P,K as L,r as _,v as g,a0 as $,L as M,e as j,N as S,O as T,P as m,j as o,Q as W,S as v,T as e,U as h,W as B,X as F,Y as q,Z as I,a1 as J,a2 as K,a3 as x,a4 as U,$ as O}from"./index-61b51ec3.js";import{r as c,e as Q,_ as E,m as N,c as X,V as Y}from"./VForm-82eaf2f4.js";const Z=p=>Math.floor(Math.random()*p),z={en:"Registration",ru:"Регистрация"},G={en:"Name",ru:"Имя"},H={en:"Email",ru:"Email"},ee={en:"Password",ru:"Пароль"},ae={en:"Repeat password",ru:"Повторите пароль"},se={en:"Create",ru:"Создать"},le={en:"already have an account",ru:"уже есть аккаунт"},te={en:"Email is already in use",ru:"Email уже используется"},r={title:z,name:G,email:H,password:ee,repassword:ae,create:se,already_have_an_account:le,email_is_already_in_use:te},re={class:"text-h4 text-center mb-4"},oe=P({__name:"RegistrationFormModule",setup(p){const l=L({name:"",email:"",password:"",repeatPassword:""}),u=_(null),k=g("fbAuth"),w=g("fbDB"),i=_(!1),d=_(!1),A=$(),C=M(),t=j(()=>C.lang),V=["#F06292","#BA68C8","#42A5F5","#66BB6A","#FF7043","#651FFF","#536DFE","#00B8D4","#00BFA5"],D=async()=>{if(!u.value)return;const{valid:f}=await u.value.validate();if(f&&!d.value){const{email:a,password:s,name:b}=l,R=V[Z(V.length-1)];i.value=!0,J(k,a,s).then(async n=>{const y={uid:n.user.uid,displayName:b,email:a,photoURL:null,color:R};u.value.reset(),await K(n.user,{displayName:b}),await x(U(w,"users",n.user.uid),y),A.setUser(y),await x(U(w,"userChats",n.user.uid),{})}).catch(n=>{n.code==="auth/email-already-in-use"&&(d.value=!0)}).finally(()=>i.value=!1)}};return(f,a)=>(S(),T(I,{style:{width:"375px"}},{default:m(()=>[o(Y,{class:"pa-6",onSubmit:q(D,["prevent"]),ref_key:"formEl",ref:u,disabled:i.value},{default:m(()=>[W("p",re,v(e(r).title[t.value]),1),o(h,{modelValue:l.name,"onUpdate:modelValue":a[0]||(a[0]=s=>l.name=s),variant:"outlined",label:e(r).name[t.value],rules:[e(c)]},null,8,["modelValue","label","rules"]),o(h,{modelValue:l.email,"onUpdate:modelValue":[a[1]||(a[1]=s=>l.email=s),a[2]||(a[2]=()=>d.value=!1)],class:"mt-2",variant:"outlined",label:e(r).email[t.value],rules:[e(Q),e(c)],"error-messages":d.value?[e(r).email_is_already_in_use[t.value]]:[]},null,8,["modelValue","label","rules","error-messages"]),o(E,{modelValue:l.password,"onUpdate:modelValue":a[3]||(a[3]=s=>l.password=s),class:"mt-2",variant:"outlined",label:e(r).password[t.value],rules:[e(c),s=>e(N)(s,6)]},null,8,["modelValue","label","rules"]),o(E,{modelValue:l.repeatPassword,"onUpdate:modelValue":a[4]||(a[4]=s=>l.repeatPassword=s),class:"mt-2",variant:"outlined",label:e(r).repassword[t.value],rules:[e(c),s=>e(N)(s,6),s=>e(X)(s,l.password)]},null,8,["modelValue","label","rules"]),o(B,{class:"mt-3",color:"primary",block:"",type:"submit",loading:i.value},{default:m(()=>[F(v(e(r).create[t.value]),1)]),_:1},8,["loading"]),o(B,{class:"text-lowercase",variant:"text",block:"",disabled:i.value,onClick:a[5]||(a[5]=()=>f.$router.push("/login"))},{default:m(()=>[F(v(e(r).already_have_an_account[t.value]),1)]),_:1},8,["disabled"])]),_:1},8,["onSubmit","disabled"])]),_:1}))}}),ne={class:"d-flex justify-center align-center h-100"},de=P({__name:"RegistrationPage",setup(p){return(l,u)=>(S(),O("div",ne,[o(e(oe))]))}});export{de as default};
